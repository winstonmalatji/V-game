<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>For Londiwe ‚ù§Ô∏è</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, sans-serif;
    background: #ff9a9e;
    overflow: hidden;
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
    width: 100vw;
    height: 100vh;
    height: 100dvh;
  }

  .screen {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: linear-gradient(180deg, #ff9a9e, #fad0c4);
    z-index: 10;
    padding: 20px;
    box-sizing: border-box;
  }

  .visible-flex { display: flex !important; }
  .visible-block { display: block !important; }

  h1 {
    font-size: 2rem;
    margin-bottom: 20px;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    color: #fff;
    text-align: center;
  }

  p {
    font-size: 1.2rem;
    color: #fff;
    margin: 10px 0;
    line-height: 1.5;
    text-align: center;
    max-width: 90%;
  }

  #score {
    position: absolute;
    top: max(20px, env(safe-area-inset-top));
    left: 0;
    width: 100%;
    text-align: center;
    font-size: 1.5rem;
    font-weight: bold;
    color: #fff;
    z-index: 5;
    pointer-events: none;
  }

  #basket {
    position: absolute;
    bottom: max(30px, env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    font-size: 4.5rem;
    line-height: 1;
    z-index: 5;
    /* allow pointer events so its bounding box is correct */
    pointer-events: auto;
    touch-action: none;
  }

  .heart {
    position: absolute;
    top: -50px;
    font-size: 2.5rem;
    z-index: 4;
    pointer-events: none;
  }

  #screen-end {
    background: rgba(0,0,0,0.9);
    z-index: 100;
  }

  #screen-end h2 {
    font-size: 2.5rem;
    color: #ff9a9e;
    margin-bottom: 20px;
  }

  button {
    margin-top: 25px;
    padding: 15px 40px;
    font-size: 1.2rem;
    border: none;
    border-radius: 50px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
  }

  button:active { transform: scale(0.95); }

  .primary { background: #fff; color: #ff9a9e; }
  .yes { background: #ff4d6d; color: #fff; margin: 10px; }
  .no { background: #fff; color: #333; margin: 10px; }

  .btn-group { display: flex; gap: 10px; }

  /* ensure the game screen doesn't allow browser gestures (so pointermove works) */
  #screen-game {
    touch-action: none;
  }
</style>
</head>
<body>

<div id="screen-greeting" class="screen visible-flex">
  <h1>Hi Londiwe ‚ù§Ô∏è</h1>
  <p>I made a little game just for you.</p>
  <button class="primary" onclick="goToInstructions()">Next</button>
</div>

<div id="screen-instructions" class="screen">
  <h1>How to play</h1>
  <p>1. Drag your finger anywhere left & right.</p>
  <p>2. Catch the falling hearts.</p>
  <p>3. Collect 7 hearts to win.</p>
  <button class="primary" onclick="goToGame()">Start</button>
</div>

<div id="screen-game" class="screen">
  <div id="score">0 / 7</div>
  <div id="basket">üíù</div>
</div>

<div id="screen-end" class="screen">
  <h2 id="endTitle">Londiwe...</h2>
  <p id="endMessage">I loved making this for you.</p>
  <p id="endQuestion">Will you be my Valentine? ‚ù§Ô∏è</p>
  <div class="btn-group" id="finalButtons">
    <button class="yes" onclick="answerYes()">YES</button>
    <button class="no" onclick="answerNo()">NO</button>
  </div>
</div>

<script>
  let score = 0;
  const target = 7;
  let spawnLoop;
  let activeHearts = [];
  const basket = document.getElementById("basket");
  const scoreText = document.getElementById("score");
  let gameRunning = false;

  function switchScreen(screenId, displayType = 'flex') {
    document.querySelectorAll('.screen').forEach(s => {
      s.classList.remove('visible-flex');
      s.classList.remove('visible-block');
    });

    const targetScreen = document.getElementById(screenId);
    if (displayType === 'flex') {
      targetScreen.classList.add('visible-flex');
    } else {
      targetScreen.classList.add('visible-block');
    }
  }

  function goToInstructions() {
    switchScreen('screen-instructions');
  }

  function goToGame() {
    switchScreen('screen-game', 'block');
    // center basket horizontally at start
    basket.style.left = (window.innerWidth / 2) + "px";
    startGameLogic();
  }

  function goToEnd() {
    gameRunning = false;
    clearInterval(spawnLoop);
    activeHearts.forEach(h => {
        h.element.remove();
        clearInterval(h.interval);
    });
    activeHearts = [];
    switchScreen('screen-end');
  }

  function startGameLogic() {
    score = 0;
    scoreText.textContent = `0 / ${target}`;
    gameRunning = true;
    spawnLoop = setInterval(createHeart, 800);
  }

  // Use pointer events (works for mouse, touch, pen)
  window.addEventListener("pointermove", function(e) {
    if (!gameRunning) return;
    // Only handle primary pointer to avoid multitouch conflicts
    if (!e.isPrimary) return;

    let x = e.clientX;
    // keep inside viewport
    x = Math.max(0, Math.min(window.innerWidth, x));
    basket.style.left = x + "px";
  });

  // Also prevent default on pointerdown inside the game screen so the browser doesn't try to scroll
  document.getElementById('screen-game').addEventListener('pointerdown', function(e) {
    if (gameRunning) e.preventDefault();
  }, { passive: false });

  function createHeart() {
    const container = document.getElementById('screen-game');
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = "‚ù§Ô∏è";
    // ensure we don't place hearts off-screen to the right
    heart.style.left = Math.random() * (window.innerWidth - 50) + "px";
    container.appendChild(heart);

    let y = -60;
    const speed = 4 + Math.random() * 3;

    const fall = setInterval(() => {
      y += speed;
      heart.style.top = y + "px";

      // Collision
      const hRect = heart.getBoundingClientRect();
      const bRect = basket.getBoundingClientRect();

      if (
        hRect.bottom > bRect.top + 10 &&
        hRect.top < bRect.bottom &&
        hRect.right > bRect.left &&
        hRect.left < bRect.right
      ) {
        score++;
        scoreText.textContent = `${score} / ${target}`;

        heart.remove();
        clearInterval(fall);

        if (score >= target) {
          goToEnd();
        }
      }

      if (y > window.innerHeight + 50) {
        // remove when off-screen
        heart.remove();
        clearInterval(fall);
      }
    }, 16);

    activeHearts.push({ element: heart, interval: fall });
  }

  function answerYes() {
    document.getElementById('endTitle').textContent = "Yay! ‚ù§Ô∏è";
    document.getElementById('endMessage').textContent = "You just made my day!";
    //document.getElementById('endQuestion').textContent = "Happy Valentine‚Äôs Day!";
    document.getElementById('finalButtons').style.display = 'none';
    launchConfetti();
  }

  function answerNo() {
    document.getElementById('endTitle').textContent = "Okay üå∏";
    document.getElementById('endMessage').textContent = "Thanks for playing anyway.";
    document.getElementById('endQuestion').textContent = "You're still awesome.";
    document.getElementById('finalButtons').style.display = 'none';
  }

  function launchConfetti() {
    for (let i = 0; i < 50; i++) {
      const c = document.createElement("div");
      c.textContent = "üíñ";
      c.style.position = "fixed";
      c.style.left = Math.random() * 100 + "vw";
      c.style.top = "-20px";
      c.style.fontSize = (Math.random() * 20 + 20) + "px";
      c.style.zIndex = "200";
      document.body.appendChild(c);

      let y = -20;
      const speed = 3 + Math.random() * 4;
      const fall = setInterval(() => {
        y += speed;
        c.style.top = y + "px";
        if (y > window.innerHeight + 50) {
          c.remove();
          clearInterval(fall);
        }
      }, 16);
    }
  }
</script>
</body>
</html>

